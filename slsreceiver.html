<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>slsReceiver/ slsMultiReceiver &mdash; slsDetectorPackage  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/extra.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Troubleshooting" href="troubleshooting.html" />
    <link rel="prev" title="Receivers" href="receivers.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            slsDetectorPackage
          </a>
              <div class="version">
                8.0.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="dependencies.html">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="consuming.html">Consuming slsDetectorPackage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">C++ API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="detector.html">Detector</a></li>
<li class="toctree-l1"><a class="reference internal" href="result.html">Result</a></li>
<li class="toctree-l1"><a class="reference internal" href="receiver_api.html">Receiver</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pygettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="pydetector.html">Detector</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyenums.html">Enums</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyexamples.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Command line</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="commandline.html">Command line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start_guide.html">Quick Start Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="container_utils.html">ContainerUtils</a></li>
<li class="toctree-l1"><a class="reference internal" href="type_traits.html">TypeTraits</a></li>
<li class="toctree-l1"><a class="reference internal" href="ToString.html">ToString</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Firmware</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="firmware.html">Firmware Upgrade</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Detector Server</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="servers.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="serverupgrade.html">Upgrade</a></li>
<li class="toctree-l1"><a class="reference internal" href="virtualserver.html">Simulators</a></li>
<li class="toctree-l1"><a class="reference internal" href="serverdefaults.html">Default Values</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Detector UDP Header</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="udpheader.html">Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="udpconfig.html">Config file</a></li>
<li class="toctree-l1"><a class="reference internal" href="udpdetspec.html">Detector Specific Fields</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Receiver</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="receivers.html">Receivers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">slsReceiver/ slsMultiReceiver</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#client-commands">Client Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zmq-json-header-format">ZMQ: Json Header Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sls-receiver-header-format">SLS Receiver Header Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#file-format">File format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#performance">Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-callbacks">Using Callbacks</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Troubleshooting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">slsDetectorPackage</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">slsReceiver/ slsMultiReceiver</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/slsreceiver.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="slsreceiver-slsmultireceiver">
<h1>slsReceiver/ slsMultiReceiver<a class="headerlink" href="#slsreceiver-slsmultireceiver" title="Permalink to this heading"></a></h1>
<div class="line-block">
<div class="line">One has to start the slsReceiver before loading config file or using any receiver commands (prefix: <strong>rx_</strong> )</div>
</div>
<dl>
<dt>For a Single Module</dt><dd><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># default port 1954</span>
slsReceiver

<span class="c1"># custom port 2012</span>
slsReceiver<span class="w"> </span>-t2012
</pre></div>
</div>
</dd>
<dt>For Multiple Modules</dt><dd><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># each receiver (for each module) requires a unique tcp port (if all on same machine)</span>

<span class="c1"># using slsReceiver in multiple consoles</span>
slsReceiver
slsReceiver<span class="w"> </span>-t1955

<span class="c1"># slsMultiReceiver [starting port] [number of receivers]</span>
slsMultiReceiver<span class="w"> </span><span class="m">2012</span><span class="w"> </span><span class="m">2</span>

<span class="c1"># slsMultiReceiver [starting port] [number of receivers] [print each frame header for debugging]</span>
slsMultiReceiver<span class="w"> </span><span class="m">2012</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
</dd>
</dl>
<section id="client-commands">
<h2>Client Commands<a class="headerlink" href="#client-commands" title="Permalink to this heading"></a></h2>
<div class="line-block">
<div class="line">One can remove <strong>udp_dstmac</strong> from the config file, as the slsReceiver fetches this from the <strong>udp_ip</strong>.</div>
</div>
<div class="line-block">
<div class="line">One can use “auto” for <strong>udp_dstip</strong> if one wants to use default ip of <strong>rx_hostname</strong>.</div>
</div>
<div class="line-block">
<div class="line">The first command to the receiver (<strong>rx_</strong> commands) should be <strong>rx_hostname</strong>. The following are the different ways to establish contact.</div>
</div>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># default receiver tcp port (1954)</span>
rx_hostname<span class="w"> </span>xxx

<span class="c1"># custom receiver port</span>
rx_hostname<span class="w"> </span>xxx:1957

<span class="c1"># custom receiver port</span>
rx_tcpport<span class="w"> </span><span class="m">1954</span>
rx_hostname<span class="w"> </span>xxx

<span class="c1"># multi modules with custom ports</span>
rx_hostname<span class="w"> </span>xxx:1955+xxx:1956+


<span class="c1"># multi modules using increasing tcp ports when using multi detector command</span>
rx_tcpport<span class="w"> </span><span class="m">1955</span>
rx_hostname<span class="w"> </span>xxx

<span class="c1"># or specify multi modules with custom ports on same rxr pc</span>
<span class="m">0</span>:rx_tcpport<span class="w"> </span><span class="m">1954</span>
<span class="m">1</span>:rx_tcpport<span class="w"> </span><span class="m">1955</span>
<span class="m">2</span>:rx_tcpport<span class="w"> </span><span class="m">1956</span>
rx_hostname<span class="w"> </span>xxx

<span class="c1"># multi modules with custom ports on different rxr pc</span>
<span class="m">0</span>:rx_tcpport<span class="w"> </span><span class="m">1954</span>
<span class="m">0</span>:rx_hostname<span class="w"> </span>xxx
<span class="m">1</span>:rx_tcpport<span class="w"> </span><span class="m">1955</span>
<span class="m">1</span>:rx_hostname<span class="w"> </span>yyy
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">Example commands:</div>
</div>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># to get a list of receiver commands (these dont include file commands)</span>
sls_detector_get<span class="w"> </span>list<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>rx_

<span class="c1"># some file commands are:</span>
fwrite
foverwrite
findex
fpath
fname
fmaster
fformat

<span class="c1"># to get help on a single commands</span>
sls_detector_get<span class="w"> </span>-h<span class="w"> </span>rx_framescaught
</pre></div>
</div>
</div></blockquote>
</section>
<section id="zmq-json-header-format">
<h2>ZMQ: Json Header Format<a class="headerlink" href="#zmq-json-header-format" title="Permalink to this heading"></a></h2>
<p><strong>Change in field names from slsDetectorPackage v6.x.x to v7.0.0</strong></p>
<ul class="simple">
<li><p>detSpec1 &lt;- bunchId</p></li>
<li><p>detSpec2 &lt;- reserved</p></li>
<li><p>detSpec3 &lt;- debug</p></li>
<li><p>detSpec4 &lt;- roundRNumber</p></li>
</ul>
<p><strong>Format</strong></p>
<blockquote>
<div><blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">{</span>
<span class="w">    </span><span class="s2">&quot;jsonversion&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;bitmode&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;fileIndex&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>long<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;detshape&quot;</span>:<span class="w"> </span><span class="o">[</span>
<span class="w">        </span>unsigned<span class="w"> </span>int,
<span class="w">        </span>unsigned<span class="w"> </span>int
<span class="w">    </span><span class="o">]</span>,
<span class="w">    </span><span class="s2">&quot;shape&quot;</span>:<span class="w"> </span><span class="o">[</span>
<span class="w">        </span>unsigned<span class="w"> </span>int,
<span class="w">        </span>unsigned<span class="w"> </span>int
<span class="w">    </span><span class="o">]</span>,
<span class="w">    </span><span class="s2">&quot;size&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;acqIndex&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>long<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;frameIndex&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>long<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;progress&quot;</span>:<span class="w"> </span>double,
<span class="w">    </span><span class="s2">&quot;fname&quot;</span>:<span class="w"> </span>string,
<span class="w">    </span><span class="s2">&quot;data&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;completeImage&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>int,

<span class="w">    </span><span class="s2">&quot;frameNumber&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>long<span class="w"> </span>long<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;expLength&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;packetNumber&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;detSpec1&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>long<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;timestamp&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>long<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;modId&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;row&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;column&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;detSpec2&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;detSpec3&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;detSpec4&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;detType&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;version&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>int,

<span class="w">    </span><span class="s2">&quot;flipRows&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;quad&quot;</span>:<span class="w"> </span>unsigned<span class="w"> </span>int,
<span class="w">    </span><span class="s2">&quot;addJsonHeader&quot;</span>:<span class="w"> </span><span class="o">{</span>
<span class="w">        </span>string<span class="w"> </span>:<span class="w"> </span>string
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Field</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p>jsonversion</p></td>
<td><p>Version of the json header.
Value at 4 for v6.x.x and v7.x.x</p></td>
</tr>
<tr class="row-odd"><td><p>bitmode</p></td>
<td><p>Bits per pixel [4|8|16|32]</p></td>
</tr>
<tr class="row-even"><td><p>fileIndex</p></td>
<td><p>Current file acquisition index</p></td>
</tr>
<tr class="row-odd"><td><p>detshape</p></td>
<td><p>Geometry of the entire detector</p></td>
</tr>
<tr class="row-even"><td><p>shape</p></td>
<td><p>Geometry of the current port streamed out</p></td>
</tr>
<tr class="row-odd"><td><p>size</p></td>
<td><p>Size of image of current port in bytesout</p></td>
</tr>
<tr class="row-even"><td><p>acqIndex</p></td>
<td><p>Frame number from the detector (redundant)</p></td>
</tr>
<tr class="row-odd"><td><p>frameIndex</p></td>
<td><p>Frame number of current acquisition
(Starting at 0)</p></td>
</tr>
<tr class="row-even"><td><p>progress</p></td>
<td><p>Progress of current acquisition in %</p></td>
</tr>
<tr class="row-odd"><td><p>fname</p></td>
<td><p>Current file name</p></td>
</tr>
<tr class="row-even"><td><p>data</p></td>
<td><p>1 if there is data following
0 if dummy header</p></td>
</tr>
<tr class="row-odd"><td><p>completeImage</p></td>
<td><p>1 if no missing packets for this frame
in this port, else 0</p></td>
</tr>
<tr class="row-even"><td><p>frameNumber</p></td>
<td><p>Frame number
[From detector udp header]</p></td>
</tr>
<tr class="row-odd"><td><p>expLength</p></td>
<td><p>subframe number (32 bit eiger)
or real time exposure time in 100ns (others)
[From detector udp header]</p></td>
</tr>
<tr class="row-even"><td><p>packetNumber</p></td>
<td><p>Number of packets caught for that frame</p></td>
</tr>
<tr class="row-odd"><td><p>detSpec1</p></td>
<td><p>See <a class="reference internal" href="udpdetspec.html#detector-specific-fields"><span class="std std-ref">here</span></a>
[From detector udp header]</p></td>
</tr>
<tr class="row-even"><td><p>timestamp</p></td>
<td><p>Timestamp with 10 MHz clock
[From detector udp header]</p></td>
</tr>
<tr class="row-odd"><td><p>modId</p></td>
<td><p>Module Id
[From detector udp header]</p></td>
</tr>
<tr class="row-even"><td><p>row</p></td>
<td><p>Row number in detector
[From detector udp header]</p></td>
</tr>
<tr class="row-odd"><td><p>column</p></td>
<td><p>Column number in detector
[From detector udp header]</p></td>
</tr>
<tr class="row-even"><td><p>detSpec2</p></td>
<td><p>See <a class="reference internal" href="udpdetspec.html#detector-specific-fields"><span class="std std-ref">here</span></a>
[From detector udp header]</p></td>
</tr>
<tr class="row-odd"><td><p>detSpec3</p></td>
<td><p>See <a class="reference internal" href="udpdetspec.html#detector-specific-fields"><span class="std std-ref">here</span></a>
[From detector udp header]</p></td>
</tr>
<tr class="row-even"><td><p>detSpec4</p></td>
<td><p>See <a class="reference internal" href="udpdetspec.html#detector-specific-fields"><span class="std std-ref">here</span></a>
[From detector udp header]</p></td>
</tr>
<tr class="row-odd"><td><p>detType
detSpec3</p></td>
<td><p>Detector type enum
See <span class="xref std std-ref">Detector enum</span>
[From detector udp header]</p></td>
</tr>
<tr class="row-even"><td><p>version</p></td>
<td><p>Detector header version. At 2
[From detector udp header]</p></td>
</tr>
<tr class="row-odd"><td><p>flipRows</p></td>
<td><p>1 if rows should be flipped.
Usually for Eiger bottom.</p></td>
</tr>
<tr class="row-even"><td><p>quad</p></td>
<td><p>1 if its an Eiger quad.</p></td>
</tr>
<tr class="row-odd"><td><p>addJsonHeader</p></td>
<td><p>Optional custom parameters that is required
for processing code.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
<section id="sls-receiver-header-format">
<h2>SLS Receiver Header Format<a class="headerlink" href="#sls-receiver-header-format" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>It is 112 bytes and consists of:</dt><dd><ul class="simple">
<li><p>48 bytes of the SLS Detector Header (described in <a class="reference internal" href="udpheader.html#detector-udp-header"><span class="std std-ref">the current detector header</span></a>)</p></li>
<li><p>64 bytes of packet mask</p></li>
</ul>
</dd>
</dl>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">frameNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">expLength</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">packetNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">detSpec1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">timestamp</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">modId</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">row</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">column</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">detSpec2</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">detSpec3</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">detSpec4</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">detType</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">version</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span><span class="n">sls_detector_header</span><span class="p">;</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">sls_receiver_header</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sls_detector_header</span><span class="w"> </span><span class="n">detHeader</span><span class="p">;</span><span class="w"> </span><span class="cm">/**&lt; is the detector header */</span>
<span class="w">    </span><span class="n">sls_bitset</span><span class="w"> </span><span class="n">packetsMask</span><span class="p">;</span><span class="w">        </span><span class="cm">/**&lt; is the packets caught bit mask */</span>
<span class="p">};</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<div class="line-block">
<div class="line">The packetNumber in the SLS Receiver Header will be modified to number of packets caught by receiver for that frame. For eg. Jungfrau will have 128 packets per frame. If it is less, then this is a partial frame due to missing packets.</div>
</div>
<div class="line-block">
<div class="line">Furthermore, the bit mask will specify which packets have been received.</div>
</div>
</div>
</section>
<section id="file-format">
<h2>File format<a class="headerlink" href="#file-format" title="Permalink to this heading"></a></h2>
<p>Master file is in json format.</p>
<p>The file name format is [fpath]/[fname]_dx_fy_[findex].raw, where x is module index and y is file index. <strong>fname</strong> is file name prefix and by default “run”. <strong>fpath</strong> is ‘/’ by default.</p>
<p>Each acquisition will have an increasing acquisition index or findex (if file write enabled). This can be retrieved by using <strong>findex</strong> command.</p>
<p>Each acquisition can have multiple files (the file index number <strong>y</strong>), with <strong>rx_framesperfile</strong> being the maximum number of frames per file. The default varies for each detector type.</p>
<p>Some file name examples:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># first file</span>
path-to-file/run_d0_f0_0.raw

<span class="c1"># second file after reaching max frames in first file</span>
path-to-file/run_d0_f1_0.raw

<span class="c1"># second acquisition, first file</span>
path-to-file/run_d0_f0_1.raw
</pre></div>
</div>
</div></blockquote>
<p>Each acquisition will create a master file that can be enabled/disabled using <strong>fmaster</strong>. This should have parameters relevant to the acquisition.</p>
<p><strong>Binary file format</strong></p>
<p>This is the default file format.</p>
<p>Each data file will consist of frames, each consisting of slsReceiver Header followed by data for 1 frame.</p>
<p>Master file is of ASCII format and will also include the format of the slsReceiver Header.</p>
<p><strong>HDF5 file formats</strong></p>
<ol class="arabic">
<li><p>Compile the package with HDF5 option enabled</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Using cmk script: ./cmk.sh -hj9 -d [path of hdf5 dir]</p></li>
<li><p>Enable using cmake <strong>-DCMAKE_INSTALL_PREFIX=/path/to/hdf/installation</strong> and <strong>-DSLS_USE_HDF5=ON</strong></p></li>
</ol>
</div></blockquote>
</li>
<li><p>Start Receiver process</p></li>
<li><p>Load config file</p></li>
<li><dl>
<dt>Set file format from client or in config file</dt><dd><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sls_detector_put<span class="w"> </span>fformat<span class="w"> </span>hdf5
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
<div class="line-block">
<div class="line">For multiple, modules, a virtual file linking all the modules is created. Both the data files and virtual files are linked in the master file.</div>
</div>
</section>
<section id="performance">
<h2>Performance<a class="headerlink" href="#performance" title="Permalink to this heading"></a></h2>
<p>Please refer to Receiver PC Tuning options and slsReceiver Tuning under <a class="reference external" href="https://slsdetectorgroup.github.io/devdoc/troubleshooting.html">Troubleshooting</a>.</p>
</section>
<section id="using-callbacks">
<h2>Using Callbacks<a class="headerlink" href="#using-callbacks" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>One can get a callback in the receiver for each frame to:</dt><dd><ul class="simple">
<li><p>manipulate the data that will be written to file, or</p></li>
<li><p>disable file writing in slsReceiver and take care of the data for each call back</p></li>
</ul>
</dd>
</dl>
<p>When handling callbacks, the control should be returned as soon as possible, to prevent packet loss from fifo being full.</p>
<dl>
<dt><strong>Example</strong></dt><dd><ul>
<li><p><a class="reference external" href="https://github.com/slsdetectorgroup/api-examples/blob/master/e4-receiver_callbacks.cpp">main cpp file</a></p></li>
<li><p><a class="reference external" href="https://github.com/slsdetectorgroup/api-examples/blob/master/CMakeLists.txt">cmake file</a>.</p></li>
<li><p>how to install the slsDetectorPackage with cmake is provided <a class="reference internal" href="installation.html#build-from-source-using-cmake"><span class="std std-ref">here</span></a>.</p></li>
<li><p>compile the example <strong>e4-rxr</strong> by:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cmake<span class="w"> </span>../path/to/your/source<span class="w"> </span>-DCMAKE_PREFIX_PATH<span class="o">=</span>/path/to/sls/install
make
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="receivers.html" class="btn btn-neutral float-left" title="Receivers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="troubleshooting.html" class="btn btn-neutral float-right" title="Troubleshooting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, PSD Detector Group.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>